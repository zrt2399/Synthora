<!--
    // (c) Copyright Microsoft Corporation.
    // This source is subject to the Microsoft Public License (Ms-PL).
    // Please see http://go.microsoft.com/fwlink/?LinkID=131993 for details.
    // All other rights reserved.
-->

<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:sys="using:System"
                    x:ClassModifier="internal">

    <ControlTheme x:Key="{x:Type CalendarDatePicker}" TargetType="CalendarDatePicker">
        <Setter Property="Background" Value="{DynamicResource ThemeBackgroundBrush}" />
        <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorderMidBrush}" />
        <Setter Property="BorderThickness" Value="{DynamicResource ThemeBorderThickness}" />
        <Setter Property="CornerRadius" Value="{DynamicResource ThemeBorderCornerRadius}" />
        <Setter Property="Padding" Value="4" />

        <Setter Property="Template">
            <ControlTemplate>
                <Grid ColumnDefinitions="*,Auto">

                    <Grid.Styles>

                        <Style Selector="Button.CalendarDropDown">
                            <Setter Property="Template">
                                <ControlTemplate>
                                    <Grid Width="19"
                                          Height="18"
                                          Margin="0"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center"
                                          Background="{DynamicResource ThemeControlLowBrush}"
                                          ClipToBounds="False"
                                          ColumnDefinitions="*,*,*,*"
                                          RowDefinitions="23*,19*,19*,19*">

                                        <Border Name="Highlight"
                                                Grid.Row="0"
                                                Grid.RowSpan="4"
                                                Grid.ColumnSpan="4"
                                                Margin="-1"
                                                BorderBrush="{DynamicResource HighlightBrush}"
                                                BorderThickness="1" />
                                        <Border Name="Background"
                                                Grid.Row="1"
                                                Grid.RowSpan="3"
                                                Grid.ColumnSpan="4"
                                                Margin="0,-1,0,0"
                                                BorderBrush="{DynamicResource ThemeBorderHighBrush}"
                                                BorderThickness="1"
                                                CornerRadius=".5" />
                                        <Rectangle Grid.RowSpan="1"
                                                   Grid.ColumnSpan="4"
                                                   Fill="{DynamicResource ThemeAccentBrush}"
                                                   Stroke="{DynamicResource ThemeBorderHighBrush}"
                                                   StrokeThickness="1" />
                                        <TextBlock Grid.Row="1"
                                                   Grid.RowSpan="3"
                                                   Grid.Column="0"
                                                   Grid.ColumnSpan="4"
                                                   Margin="0,-1,0,0"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   FontSize="{DynamicResource FontSizeNormal}"
                                                   Foreground="{DynamicResource ThemeBorderHighBrush}"
                                                   Text="{Binding Source={x:Static sys:DateTime.Today}, Path=Day}" />

                                        <Ellipse Grid.ColumnSpan="4"
                                                 Width="3"
                                                 Height="3"
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Center"
                                                 Fill="{DynamicResource ThemeControlLowBrush}"
                                                 StrokeThickness="0" />
                                    </Grid>
                                </ControlTemplate>
                            </Setter>
                        </Style>

                        <Style Selector="Button.CalendarDropDown /template/ Border#Highlight">
                            <Setter Property="IsVisible" Value="False" />
                        </Style>
                        <Style Selector="Button.CalendarDropDown:pressed /template/ Border#Highlight">
                            <Setter Property="IsVisible" Value="True" />
                        </Style>

                        <Style Selector="Button.CalendarDropDown:pointerover /template/ Border#Background">
                            <Setter Property="Background" Value="{DynamicResource ThemeAccentBrush4}" />
                        </Style>

                    </Grid.Styles>

                    <TextBox Name="PART_TextBox"
                             Grid.Column="0"
                             Padding="{TemplateBinding Padding}"
                             HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                             VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                             Background="{TemplateBinding Background}"
                             BorderBrush="{TemplateBinding BorderBrush}"
                             BorderThickness="{TemplateBinding BorderThickness}"
                             CornerRadius="{TemplateBinding CornerRadius}"
                             DataValidationErrors.Errors="{TemplateBinding (DataValidationErrors.Errors)}"
                             UseFloatingWatermark="{TemplateBinding UseFloatingWatermark}"
                             Watermark="{TemplateBinding Watermark}">
                        <TextBox.InnerRightContent>
                            <Button Name="PART_Button"
                                    Grid.Column="1"
                                    Width="12"
                                    Height="12"
                                    Margin="4,0,0,0"
                                    Padding="0"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Cursor="Arrow"
                                    Focusable="False"
                                    Foreground="{TemplateBinding Foreground}">
                                <PathIcon Width="12"
                                          Height="12"
                                          Data="M9,10V12H7V10H9M13,10V12H11V10H13M17,10V12H15V10H17M19,3A2,2 0 0,1 21,5V19A2,2 0 0,1 19,21H5C3.89,21 3,20.1 3,19V5A2,2 0 0,1 5,3H6V1H8V3H16V1H18V3H19M19,19V8H5V19H19M9,14V16H7V14H9M13,14V16H11V14H13M17,14V16H15V14H17Z" />
                            </Button>
                        </TextBox.InnerRightContent>
                    </TextBox>

                    <Popup Name="PART_Popup"
                           IsLightDismissEnabled="True"
                           Placement="BottomEdgeAlignedLeft"
                           PlacementTarget="{TemplateBinding}"
                           WindowManagerAddShadowHint="False">
                        <Border Margin="{DynamicResource PopupBoxShadowMargin}"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                BoxShadow="{DynamicResource PopupBoxShadow}"
                                CornerRadius="{TemplateBinding CornerRadius}">
                            <Calendar Name="PART_Calendar"
                                      BorderBrush="Transparent"
                                      CornerRadius="{TemplateBinding CornerRadius}"
                                      DisplayDate="{TemplateBinding DisplayDate}"
                                      DisplayDateEnd="{TemplateBinding DisplayDateEnd}"
                                      DisplayDateStart="{TemplateBinding DisplayDateStart}"
                                      FirstDayOfWeek="{TemplateBinding FirstDayOfWeek}"
                                      IsTodayHighlighted="{TemplateBinding IsTodayHighlighted}"
                                      SelectedDate="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SelectedDate, Mode=TwoWay}" />
                        </Border>
                    </Popup>
                </Grid>
            </ControlTemplate>
        </Setter>

        <Style Selector="^:focus /template/ TextBox#PART_TextBox">
            <Setter Property="BorderBrush" Value="{DynamicResource ThemeBorderHighBrush}" />
        </Style>
    </ControlTheme>
</ResourceDictionary>